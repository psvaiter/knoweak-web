<app-modal modalTitle="Cadastrar vulnerabilidade">
  <div class="body">

    <div class="ml-2 mb-2"><b>Organização:</b> {{ organization.legalName }}</div>
    <div class="ml-2 mb-4"><b>Ativo de TI:</b> {{ itAsset.name }}</div>
    
    <div class="my-2">
      <ng-select
        [disabled]="editMode"
        [items]="securityThreats"
        [searchable]="true"
        bindLabel="name"
        bindValue="id"
        [(ngModel)]="selectedSecurityThreatId"
        placeholder="Selecione uma ameaça"
        [loading]="loadingSecurityThreats"
        loadingText="Carregando...">
      </ng-select>
    </div>
    
    <div class="my-2">
      <ng-select
        [items]="ratingLevels"
        [searchable]="true"
        bindLabel="name"
        bindValue="id"
        [(ngModel)]="selectedVulnerabilityLevelId"
        placeholder="Selecione o grau de vulnerabilidade">
      </ng-select>
    </div>

    <div *ngIf="!editMode" class="alert alert-info small">
      Não encontrou a ameaça desejada? <a [routerLink]="['/organizations', organization.id, 'securityThreats']" (click)="hide()">Verifique se ela existe na organização</a>.
    </div>

    <app-error-alert [errors]="errors"></app-error-alert>
  </div>
  <div class="actions">
    <button type="submit" class="btn btn-outline-success" (click)="confirm()" [disabled]="disableSave()">Salvar</button>
  </div>
</app-modal>