import { Injectable } from '@angular/core';
import { CrudService } from '../../../shared/components/crud/crud.service';

@Injectable()
export class OrganizationItAssetVulnerabilityService {

  constructor(private crudService: CrudService) { }

  listVulnerabilities(organizationId: number, itAssetInstanceId: number, page: number, recordsPerPage: number = 10) {
    let url = `${CrudService.BaseUrl}/organizations/${organizationId}/itAssets/${itAssetInstanceId}/vulnerabilities`;
    return this.crudService.getPage(url, page, recordsPerPage);
  }

  addVulnerability(organizationId: number, itAssetInstanceId: number, data: { securityThreatId: number, vulnerabilityLevelId: number }) {
    let url = `${CrudService.BaseUrl}/organizations/${organizationId}/itAssets/${itAssetInstanceId}/vulnerabilities`;
    return this.crudService.post(url, data);
  }

  patchVulnerability(organizationId: number, itAssetInstanceId: number, securityThreatId: number, data: { vulnerabilityLevelId: number }) {
    let url = `${CrudService.BaseUrl}/organizations/${organizationId}/itAssets/${itAssetInstanceId}/vulnerabilities/${securityThreatId}`;
    return this.crudService.patch(url, data);
  }

  removeVulnerability(organizationId: number, itAssetInstanceId: number, securityThreatId: number) {
    let url = `${CrudService.BaseUrl}/organizations/${organizationId}/itAssets/${itAssetInstanceId}/vulnerabilities/${securityThreatId}`;
    return this.crudService.delete(url);
  }

}
